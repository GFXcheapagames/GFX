<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GFX Cheap Games - Diwali Sale</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

<style>
/* --- Existing CSS --- */
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:'Orbitron',sans-serif;
  background:#0b0b0b;
  color:#fff;
  overflow-x:hidden;
}
header{
  background:#111;
  padding:20px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
header img{height:50px;}
header h1{font-size:35px;color:#0ff;text-shadow:0 0 10px #0ff;}
nav a{color:#fff;margin-left:20px;text-decoration:none;font-size:16px;}
.cart-icon{position:relative;cursor:pointer;font-size:22px;}
.cart-counter{
  background:#ff0000;
  color:#fff;
  font-size:12px;
  padding:2px 6px;
  border-radius:50%;
  position:absolute;
  top:-8px;right:-8px;
}
.sale-banner{
  background:linear-gradient(90deg,#ff8c00,#ff2e2e);
  text-align:center;
  padding:25px;
  font-size:18px;
  font-weight:bold;
  color:#fff;
  text-shadow:0 0 8px #fff;
}
.container{max-width:1200px;margin:30px auto;padding:0 20px;}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;}
.product{
  background:#1c1c1c;
  padding:15px;
  border-radius:12px;
  text-align:center;
  transition:transform 0.3s,box-shadow 0.3s;
}
.product:hover{
  transform:scale(1.05);
  box-shadow:0 0 20px #0ff;
}
.product img{width:100%;border-radius:10px;}
.product h2{font-size:20px;margin:10px 0 5px;color:#0ff;text-shadow:0 0 8px #ff2e2e;}
.price{font-size:25px;margin-bottom:15px;}
.original-price{text-decoration:line-through;color:#ff4c4c;margin-right:5px;}
.discounted-price{color:#fff;font-weight:bold;}
.add-btn{
  display:inline-block;
  background:#ff9800;
  color:#000;
  padding:8px 15px;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
  transition:0.5s;
  text-decoration:none;
}
.add-btn:hover{background:#ff4c4c;color:#fff;}

/* Cart Popup */
.cart-popup{
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.95);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:1000;
  overflow-y:auto;
  padding:40px 0;
}
.cart-popup .popup-content{
  background:#111;
  padding:25px;
  border-radius:15px;
  max-width:600px;
  width:90%;
  text-align:center;
  box-shadow:0 0 30px #ff2e2e;
}
.cart-popup h2{color:#ff2e2e;margin-bottom:20px;font-size:28px;}
.cart-item{
  background:#1c1c1c;
  border-radius:10px;
  margin-bottom:15px;
  padding:15px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.cart-item img{width:100px;height:100px;object-fit:cover;border-radius:10px;}
.cart-item h3{font-size:18px;color:#ff2e2e;}
.cart-item p{font-size:16px;color:#fff;}
.delete-btn{
  background:none;
  border:none;
  color:#ff4c4c;
  font-size:22px;
  cursor:pointer;
  transition:0.3s;
}
.delete-btn:hover{color:#ff0000;transform:scale(1.1);}
.cart-actions{margin-top:25px;display:flex;justify-content:center;gap:15px;}
.checkout-btn,.clear-btn{
  background:#ff9800;
  color:#000;
  padding:10px 20px;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
  transition:0.5s;
}
.checkout-btn:hover,.clear-btn:hover{background:#ff4c4c;color:#fff;}
.close-btn{
  background:#ff4c4c;
  color:#fff;
  padding:8px 12px;
  border-radius:5px;
  cursor:pointer;
  margin-top:15px;
  display:inline-block;
}

/* Sign In / Sign Up Popup */
.auth-popup{
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.95);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:4000;
  padding:40px 0;
}
.auth-popup .popup-content{
  background:#111;
  padding:30px;
  border-radius:15px;
  max-width:400px;
  width:90%;
  text-align:center;
  box-shadow:0 0 30px #0ff;
}
.auth-popup h2{color:#0ff;margin-bottom:20px;}
.auth-popup input{
  width:90%;padding:10px;margin:10px 0;border-radius:8px;
  border:none;font-size:16px;
}
.auth-popup button{
  width:95%;padding:12px;margin:10px 0;border:none;
  border-radius:8px;font-size:16px;font-weight:bold;
  cursor:pointer;
  background:#ff9800;color:#000;
  transition:0.3s;
}
.auth-popup button:hover{background:#ff4c4c;color:#fff;}
.close-auth{background:#ff4c4c;color:#fff;}
.google-btn{background:#4285F4;color:#fff;}
.auth-msg{font-size:14px;color:#ff4c4c;margin-top:5px;}
</style>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"></script>


<script>
const provider = new firebase.auth.GoogleAuthProvider();
firebase.auth().signInWithPopup(provider)
  .then((result) => {
    const user = result.user;
    console.log("User signed in: ", user);
  })
  .catch((error) => {
    console.error("Error during sign-in: ", error);
  });

  firebase.auth().signInWithEmailAndPassword(email, password)
  .then((userCredential) => {
    const user = userCredential.user;
    console.log("User signed in: ", user);
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    console.error("Error during sign-in: ", errorCode, errorMessage);
    alert("Authentication failed: " + errorMessage);
  });


</script>

</head>
<body>

<header>
    <img src="logo.jpg" alt="GFX Cheap Games" height="300" width="80">
    <h1>GFX Cheap Games</h1>
    <nav>
        <div class="cart-icon" id="openCart">
            üõí Cart
            <span class="cart-counter" id="cartCount">0</span>
        </div>
        <span id="userDisplay" style="margin-left:20px;font-weight:bold;"></span>
        <button id="authBtn" style="margin-left:20px;padding:8px 12px;border-radius:5px;font-weight:bold;cursor:pointer;background:#0ff;color:#000;">Sign In / Sign Up</button>
        <button id="signOutBtn" style="display:none;margin-left:10px;padding:8px 12px;border-radius:5px;font-weight:bold;cursor:pointer;background:#ff4c4c;color:#fff;">Sign Out</button>
    </nav>
</header>

<div class="sale-banner">
üéÆ Diwali Sale! Up to 50% OFF on Steam Games! üéÆ
</div>

<div class="container">
    <div class="products" id="productList">
        <!-- Example Product -->
        <div class="product" data-name="Grand Theft Auto V" data-price="199">
            <img src="gta5.jfif" alt="Grand Theft Auto V">
            <h2>Grand Theft Auto V</h2>
            <div class="price"><span class="original-price">‚Çπ399</span> <span class="discounted-price">‚Çπ199</span></div>
            <button class="add-btn">Add to Cart</button>
        </div>
        <!-- Add all your other products here as in your original code -->
    </div>
</div>

<!-- CART POPUP -->
<div class="cart-popup" id="cartPopup">
  <div class="popup-content">
    <h2>Your Cart</h2>
    <div id="cartItems"></div>
    <div class="cart-actions">
      <button class="clear-btn" id="clearCart">Clear All</button>
      <a href="checkout.html" class="checkout-btn">Checkout</a>
    </div>
    <div><button class="close-btn" id="closeCart">Close</button></div>
  </div>
</div>

<!-- AUTH POPUP -->
<div class="auth-popup" id="authPopup">
  <div class="popup-content">
    <h2>Sign In / Sign Up</h2>
    <input type="email" id="email" placeholder="Email" required>
    <input type="text" id="phone" placeholder="Mobile Number (Optional)">
    <input type="password" id="password" placeholder="Password" required>
    <button id="signUpBtn">Sign Up</button>
    <button id="signInBtn">Sign In</button>
    <button class="google-btn" id="googleSignInBtn">Sign in with Google</button>
    <button class="close-auth" id="closeAuthBtn">Close</button>
    <div class="auth-msg" id="authMsg"></div>
  </div>
</div>

<script>
let cart = [];
let currentUser = null;
const CART_KEY = 'gfx_cart';

const cartCount=document.getElementById('cartCount');
const cartIcon = document.getElementById('openCart'); 
const cartPopup=document.getElementById('cartPopup');
const cartItems=document.getElementById('cartItems');
const closeCart=document.getElementById('closeCart');
const clearCart=document.getElementById('clearCart');

const authPopup = document.getElementById('authPopup');
const authBtn = document.getElementById('authBtn');
const closeAuthBtn = document.getElementById('closeAuthBtn');
const signUpBtn = document.getElementById('signUpBtn');
const signInBtn = document.getElementById('signInBtn');
const googleSignInBtn = document.getElementById('googleSignInBtn');
const authMsg = document.getElementById('authMsg');

// --- Cart Functions ---
async function renderCart(){
  cartItems.innerHTML='';
  if(cart.length===0){cartItems.innerHTML='<p>Your cart is empty.</p>'; return;}
  cart.forEach((item,i)=>{
    const div=document.createElement('div');
    div.className='cart-item';
    div.innerHTML=`
      <img src="${item.img}" alt="${item.name}">
      <div>
        <h3>${item.name}</h3>
        <p>‚Çπ${item.price}</p>
      </div>
      <button class="delete-btn" onclick="removeItem(${i})">üóëÔ∏è</button>
    `;
    cartItems.appendChild(div);
  });
  cartCount.textContent=cart.length;
}

async function updateCartStorage(){
  if(currentUser){
    await db.collection('carts').doc(currentUser.uid).set({items: cart});
  } else {
    localStorage.setItem(CART_KEY, JSON.stringify(cart));
  }
}

async function removeItem(i){
  cart.splice(i,1);
  await updateCartStorage();
  renderCart();
}

document.querySelectorAll('.add-btn').forEach(btn=>{
  btn.addEventListener('click', async e=>{
    const p=e.target.closest('.product');
    const name=p.dataset.name;
    const price=p.dataset.price;
    const img=p.querySelector('img').src;
    cart.push({name, price, img});
    await updateCartStorage();
    cartCount.textContent=cart.length;
  });
});

cartIcon.addEventListener('click', ()=>{
  renderCart();
  cartPopup.style.display='flex';
});
closeCart.addEventListener('click',()=>cartPopup.style.display='none');
clearCart.addEventListener('click', async ()=>{
  cart=[];
  await updateCartStorage();
  renderCart();
});

async function loadCart(){
  if(currentUser){
    const doc = await db.collection('carts').doc(currentUser.uid).get();
    cart = doc.exists ? doc.data().items : [];
  } else {
    cart = JSON.parse(localStorage.getItem(CART_KEY)||'[]');
  }
  renderCart();
}

// --- Auth ---
authBtn.addEventListener('click',()=>authPopup.style.display='flex');
closeAuthBtn.addEventListener('click',()=>authPopup.style.display='none');

signUpBtn.addEventListener('click', async ()=>{
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  try{
    const userCred = await auth.createUserWithEmailAndPassword(email,password);
    currentUser = userCred.user;
    authPopup.style.display='none';
    authMsg.textContent='';
    await loadCart();
  } catch(e){ authMsg.textContent = e.message; }
});

signInBtn.addEventListener('click', async ()=>{
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  try{
    const userCred = await auth.signInWithEmailAndPassword(email,password);
    currentUser = userCred.user;
    authPopup.style.display='none';
    authMsg.textContent='';
    await loadCart();
  } catch(e){ authMsg.textContent = e.message; }
});

googleSignInBtn.addEventListener('click', async ()=>{
  const provider = new firebase.auth.GoogleAuthProvider();
  try{
    const result = await auth.signInWithPopup(provider);
    currentUser = result.user;
    authPopup.style.display='none';
    await loadCart();
  } catch(e){ authMsg.textContent = e.message; }
});

// --- Sign Out ---
document.getElementById('signOutBtn').addEventListener('click', async ()=>{
  await auth.signOut();
  currentUser = null;
  cart = JSON.parse(localStorage.getItem(CART_KEY)||'[]');
  renderCart();
});

// --- Auth State ---
auth.onAuthStateChanged(async user=>{
  currentUser = user;
  if(user){
    const name = user.displayName || user.email;
    document.getElementById('userDisplay').textContent = `Hello, ${name}`;
    authBtn.style.display='none';
    document.getElementById('signOutBtn').style.display='inline-block';
  } else {
    document.getElementById('userDisplay').textContent='';
    authBtn.style.display='inline-block';
    document.getElementById('signOutBtn').style.display='none';
  }
  await loadCart();
});

// --- Load guest cart initially ---
loadCart();
</script>

</body>
</html>
