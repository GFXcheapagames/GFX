<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GFX Cheap Games - Diwali Sale</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Orbitron',sans-serif;background:#0b0b0b;color:#fff;overflow-x:hidden;}
header{background:#111;padding:20px;display:flex;align-items:center;justify-content:space-between;}
header img{height:50px;}
header h1{font-size:35px;color:#0ff;text-shadow:0 0 10px #0ff;}
nav{display:flex;align-items:center;}
nav a, nav button{margin-left:20px;text-decoration:none;font-size:16px;}
nav button{cursor:pointer;font-weight:bold;border:none;padding:8px 16px;border-radius:6px;}
nav #loginBtn{background:red;color:black;}
nav #loginBtn:hover{opacity:.8;}
.sale-banner{background:linear-gradient(90deg,#ff8c00,#ff2e2e);text-align:center;padding:25px;font-size:18px;font-weight:bold;color:#fff;text-shadow:0 0 8px #fff;}
.container{max-width:1200px;margin:30px auto;padding:0 20px;}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;}
.product{background:#1c1c1c;padding:15px;border-radius:12px;text-align:center;transition:transform 0.3s,box-shadow 0.3s;}
.product:hover{transform:scale(1.05);box-shadow:0 0 20px #0ff;}
.product img{width:100%;border-radius:10px;}
.product h2{font-size:20px;margin:10px 0 5px;color:#0ff;text-shadow:0 0 8px #ff2e2e;}
.price{font-size:25px;margin-bottom:15px;}
.original-price{text-decoration:line-through;color:#ff4c4c;margin-right:5px;}
.discounted-price{color:#fff;font-weight:bold;}
.add-btn{display:inline-block;background:#ff9800;color:#000;padding:8px 15px;border-radius:8px;font-weight:bold;cursor:pointer;transition:0.5s;text-decoration:none;}
.add-btn:hover{background:#ff4c4c;color:#fff;}

/* Cart Popup */
.cart-popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:none;justify-content:center;align-items:center;z-index:1000;overflow-y:auto;padding:40px 0;}
.cart-popup .popup-content{background:#111;padding:25px;border-radius:15px;max-width:600px;width:90%;text-align:center;box-shadow:0 0 30px #ff2e2e;}
.cart-popup h2{color:#ff2e2e;margin-bottom:20px;font-size:28px;}
.cart-item{background:#1c1c1c;border-radius:10px;margin-bottom:15px;padding:15px;display:flex;align-items:center;justify-content:space-between;}
.cart-item img{width:100px;height:100px;object-fit:cover;border-radius:10px;}
.cart-item h3{font-size:18px;color:#ff2e2e;}
.cart-item p{font-size:16px;color:#fff;}
.delete-btn{background:none;border:none;color:#ff4c4c;font-size:22px;cursor:pointer;transition:0.3s;}
.delete-btn:hover{color:#ff0000;transform:scale(1.1);}
.cart-actions{margin-top:25px;display:flex;justify-content:center;gap:15px;}
.checkout-btn,.clear-btn{background:#ff9800;color:#000;padding:10px 20px;border-radius:8px;font-weight:bold;cursor:pointer;transition:0.5s;}
.checkout-btn:hover,.clear-btn:hover{background:#ff4c4c;color:#fff;}
.close-btn{background:#ff4c4c;color:#fff;padding:8px 12px;border-radius:5px;cursor:pointer;margin-top:15px;display:inline-block;}

/* LOGIN POPUP */
#loginPopup{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);justify-content:center;align-items:center;z-index:1000;}
#loginPopup .popup-content{background:#111;padding:30px;border-radius:12px;max-width:400px;width:90%;text-align:center;color:#fff;position:relative;}
#loginPopup h2{margin-bottom:15px;}
#loginPopup input{width:90%;padding:10px;margin:8px 0;border-radius:6px;border:none;}
#loginPopup button{padding:10px 15px;border-radius:6px;border:none;margin-top:10px;font-weight:bold;cursor:pointer;}
#loginPopup #loginSubmitBtn{background:red;color:black;}
#loginPopup #googleLoginBtn{background:#4285F4;color:white;margin-bottom:15px;}
#loginMsg{margin-top:12px;color:#ff4c4c;}
#loginPopup #loginCloseBtn{background:#555;color:white;margin-top:15px;}
</style>
</head>
<body>

<header>
    <img src="logo.jpg" alt="Logo">
    <h1>GFX Cheap Games</h1>
    <nav>
        <div class="cart-icon" id="openCart">üõí Cart <span class="cart-counter" id="cartCount">0</span></div>
        <button id="loginBtn">Login</button>
    </nav>
</header>

<div class="sale-banner">üéÆ Diwali Sale! Up to 50% OFF on Steam Games! üéÆ</div>

<div class="container">
    <div class="products" id="productList">
        <!-- Example Product -->
        <div class="product" data-name="Grand Theft Auto V" data-price="199">
            <img src="gta5.jfif" alt="GTA V">
            <h2>Grand Theft Auto V</h2>
            <div class="price"><span class="original-price">‚Çπ399</span> <span class="discounted-price">‚Çπ199</span></div>
            <button class="add-btn">Add to Cart</button>
        </div>
    </div>
</div>

<!-- CART POPUP -->
<div class="cart-popup" id="cartPopup">
  <div class="popup-content">
    <h2>Your Cart</h2>
    <div id="cartItems"></div>
    <div class="cart-actions">
      <button class="clear-btn" id="clearCart">Clear All</button>
      <button class="checkout-btn" id="checkoutBtn">Checkout</button>
    </div>
    <button class="close-btn" id="closeCart">Close</button>
  </div>
</div>

<!-- LOGIN POPUP -->
<div id="loginPopup">
  <div class="popup-content">
    <h2>Login / Sign Up</h2>
    <button id="googleLoginBtn">Sign in with Google</button>
    <input type="email" id="loginEmail" placeholder="Email *">
    <input type="text" id="loginPhone" placeholder="Mobile (Optional)">
    <input type="password" id="loginPassword" placeholder="Password *">
    <button id="loginSubmitBtn">Login</button>
    <button id="loginCloseBtn">Close</button>
    <div id="loginMsg"></div>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"></script>

<script>
  // ======= REPLACE BELOW WITH YOUR FIREBASE CONFIG =======
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_MSG_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // ====== LOGIN POPUP HANDLERS ======
  const loginBtn = document.getElementById('loginBtn');
  const loginPopup = document.getElementById('loginPopup');
  const loginCloseBtn = document.getElementById('loginCloseBtn');
  const loginSubmitBtn = document.getElementById('loginSubmitBtn');
  const googleLoginBtn = document.getElementById('googleLoginBtn');
  const loginMsg = document.getElementById('loginMsg');

  loginBtn.addEventListener('click', ()=>loginPopup.style.display='flex');
  loginCloseBtn.addEventListener('click', ()=>loginPopup.style.display='none');

  // ====== CART SYSTEM ======
  const CART_KEY='gfx_cart';
  let cart=JSON.parse(localStorage.getItem(CART_KEY)||'[]');
  const cartCount=document.getElementById('cartCount');
  const cartIcon=document.getElementById('openCart'); 
  const cartPopupEl=document.getElementById('cartPopup');
  const cartItems=document.getElementById('cartItems');
  const closeCart=document.getElementById('closeCart');
  const clearCart=document.getElementById('clearCart');

  function updateCartStorage(){ localStorage.setItem(CART_KEY,JSON.stringify(cart)); }

  function renderCart(){
    cartItems.innerHTML='';
    if(cart.length===0){cartItems.innerHTML='<p>Your cart is empty.</p>';return;}
    cart.forEach((item,i)=>{
      const div=document.createElement('div');
      div.className='cart-item';
      div.innerHTML=`
        <img src="${item.img}" alt="${item.name}">
        <div><h3>${item.name}</h3><p>‚Çπ${item.price}</p></div>
        <button class="delete-btn" onclick="removeItem(${i})">üóëÔ∏è</button>
      `;
      cartItems.appendChild(div);
    });
    cartCount.textContent=cart.length;
  }

  function removeItem(i){ cart.splice(i,1); updateCartStorage(); renderCart(); }

  document.querySelectorAll('.add-btn').forEach(btn=>{
    btn.addEventListener('click',e=>{
      const p=e.target.closest('.product');
      const name=p.dataset.name;
      const price=p.dataset.price;
      const img=p.querySelector('img').src;
      cart.push({name,price,img});
      updateCartStorage();
      cartCount.textContent=cart.length;
    });
  });

  cartIcon.addEventListener('click',()=>{ renderCart(); cartPopupEl.style.display='flex'; });
  closeCart.addEventListener('click',()=>cartPopupEl.style.display='none');
  clearCart.addEventListener('click',()=>{ cart=[]; updateCartStorage(); renderCart(); });

  renderCart();

  // ====== LOGIN / SIGNUP ======
  async function mergeCartToFirestore(user){
    const userRef=db.collection('users').doc(user.uid);
    const doc=await userRef.get();
    let serverCart=[];
    if(doc.exists && doc.data().cart) serverCart=doc.data().cart;
    const merged=[...serverCart];
    cart.forEach(item=>{ if(!merged.find(i=>i.name===item.name)) merged.push(item); });
    await userRef.set({cart:merged},{merge:true});
    cart=merged; updateCartStorage(); renderCart();
  }

  googleLoginBtn.addEventListener('click',async ()=>{
    const provider=new firebase.auth.GoogleAuthProvider();
    try{
      const result=await auth.signInWithPopup(provider);
      const user=result.user;
      await db.collection('users').doc(user.uid).set({
        email:user.email,phone:'',createdAt:firebase.firestore.FieldValue.serverTimestamp()
      },{merge:true});
      await mergeCartToFirestore(user);
      loginMsg.style.color='lime'; loginMsg.textContent='Logged in successfully!';
      setTimeout(()=>loginPopup.style.display='none',1000);
    }catch(e){ loginMsg.style.color='red'; loginMsg.textContent=e.message; }
  });

  loginSubmitBtn.addEventListener('click',async ()=>{
    const email=document.getElementById('loginEmail').value.trim();
    const password=document.getElementById('loginPassword').value.trim();
    const phone=document.getElementById('loginPhone').value.trim();
    if(!email||!password){ loginMsg.textContent='Email & password required'; return; }
    loginMsg.textContent='';
    try{
      const userCredential=await auth.signInWithEmailAndPassword(email,password);
      const user=userCredential.user;
      await mergeCartToFirestore(user);
      loginMsg.style.color='lime'; loginMsg.textContent='Logged in successfully!';
      setTimeout(()=>loginPopup.style.display='none',1000);
    }catch(err){
      if(err.code==='auth/user-not-found'){
        try{
          const userCredential=await auth.createUserWithEmailAndPassword(email,password);
          const user=userCredential.user;
          await db.collection('users').doc(user.uid).set({email,phone,createdAt:firebase.firestore.FieldValue.serverTimestamp()});
          await mergeCartToFirestore(user);
          loginMsg.style.color='lime'; loginMsg.textContent='Account created & logged in!';
          setTimeout(()=>loginPopup.style.display='none',1000);
        }catch(signErr){ loginMsg.style.color='red'; loginMsg.textContent=signErr.message; }
      }else{ loginMsg.style.color='red'; loginMsg.textContent=err.message; }
    }
  });
</script>
</body>
</html>
